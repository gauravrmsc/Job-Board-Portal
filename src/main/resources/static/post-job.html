
<!doctype html>
<html lang="en">
  <head>
    <title>JobBoard &mdash; Website Template by Colorlib</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    
    <link rel="stylesheet" href="css/custom-bs.css">
    <link rel="stylesheet" href="css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="css/bootstrap-select.min.css">
    <link rel="stylesheet" href="fonts/icomoon/style.css">
    <link rel="stylesheet" href="fonts/line-icons/style.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/quill.snow.css">
    

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="css/style.css">    
  </head>
  <body id="top">

  <div id="overlayer"></div>
  <div class="loader" id = "loader">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>
    

<div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div> <!-- .site-mobile-menu -->
    

    <!-- NAVBAR -->
    <!-- <header class="site-navbar mt-3"> -->
      <!-- <div class="container-fluid">
        <div class="row align-items-center">
          <div class="site-logo col-6"><a href="index.html">JobBoard</a></div>

          <nav class="mx-auto site-navigation">
            <ul class="site-menu js-clone-nav d-none d-xl-block ml-0 pl-0">

              <li class="d-lg-none"><a href="post-job.html"><span class="mr-2">+</span> Post a Job</a></li>

            </ul>
          </nav> -->
          
          <!-- <div class="right-cta-menu text-right d-flex aligin-items-center col-6">
            <div class="ml-auto">
              <a href="post-job.html" class="btn btn-outline-white border-width-2 d-none d-lg-inline-block"><span class="mr-2 icon-add"></span>Post a Job</a>
            </div>
            <a href="#" class="site-menu-toggle js-menu-toggle d-inline-block d-xl-none mt-lg-2 ml-3"><span class="icon-menu h3 m-0 p-0 mt-2"></span></a>
          </div> -->

        <!-- </div>
      </div>
    </header> -->

    <!-- HOME -->
    <!-- <section class="section-hero overlay inner-page bg-image" style="background-image: url('images/hero_1.jpg');" id="home-section">
      <div class="container">
        <div class="row">
          <div class="col-md-7">
            <h1 class="text-white font-weight-bold">Post A Job</h1>
            <div class="custom-breadcrumbs">
              <a href="index.html">Home</a> <span class="mx-2 slash">/</span>
              <a href="index.html">Search Job</a> <span class="mx-2 slash">/</span>
              <span class="text-white"><strong>Post a Job</strong></span>
            </div>
          </div>
        </div>
      </div>
    </section> -->

    
    <section class="site-section">
      <div class="container">

        <div class="row align-items-center mb-5">
          <div class="col-lg-4 mb-4 mb-lg-0">
            <div class="d-flex align-items-center">
              <div>
                <h2>Post A Job</h2>
              </div>
              <!-- <div class="col-6">
                <a href="#" class="btn btn-block btn-primary btn-md">Save Job</a>
              </div> -->
            </div>
          </div>
          <div class = "col-lg-4"></div> 
          <div class="col-lg-4 ">
            <div class="row ">
              <!-- <div class="col-8">
                <a href="index.html" class="btn btn-block btn-light btn-md"><span class="icon-open_in_new mr-2"></span>Go To Home</a>
              </div> -->
              <div class = "col-6"></div>
              <div class="col-6 ">
                <a href="index.html" class="btn btn-block btn-link btn-md">Go To Home</a>
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-5">
          <div class="col-lg-12">
            <form class="p-4 p-md-5 border rounded" method="post" id = "job-form">
              <h3 class="text-black mb-5 border-bottom pb-2">Job Details</h3>

              <div class="form-group">
                <label for="job-title">Job Title</label>
                <input type="text" class="form-control" id="job-title" placeholder="Product Designer" required>
              </div>
              <!-- <div class="form-group">
                <label for="job-location">Location</label>
                <input type="text" class="form-control" id="job-location" placeholder="e.g. New York">
              </div> -->
              <div class="form-group">
                <label for="company-name">Company Name</label>
                <input type="text" class="form-control" id="company-name" placeholder="e.g. New York" required>
              </div>

              <div class="form-group">
                <label for="job-region">Job Region</label>
                <select class="selectpicker border rounded"  data-style="btn-black" data-width="100%" data-live-search="true" title="Select Region" id = "location-picker" required>

                    </select>
              </div>

              <div class="form-group">
                <label for="company-name">Closes in Days</label>
                <input type="number" class="form-control" id="expiry-time" placeholder="Default 60 (Only Numbers Allowed e.g 30)">
              </div>
              <div class="form-group">
                <label for="job-region">Skills Required</label>
                <select class="selectpicker border rounded" data-style="btn-black" data-width="100%" data-live-search="true" title="Skills Required" id = "skill-picker">

                    </select>
              </div>
              <div class="row" style = "color :black">
                <div class="col-md-12 selected-keywords">
                    <ul class="keywords list-unstyled m-0 p-0" id="keyword-box">

                    </ul>
                </div>
            </div>

              <div class="form-group">
                <label for="job-description">Job Description</label>
                <div class="editor" id="editor-1">
                  <p id = "job-description" >Description</p>
                </div>
              </div>


          </div>

         
      </div>
        <div class="row align-items-center mb-5">
          
          <div class="col-lg-4 ml-auto">
            <div class="row">
              <div class = "col-6"></div>
              <!-- <div class="col-6">
                <a href="#" class="btn btn-block btn-light btn-md"><span class="icon-open_in_new mr-2"></span>Preview</a>
              </div> -->
              <div class="col-6">
                <button type = "submit" class="btn btn-block btn-primary btn-md" id = "submit-button">Save Job</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
    </section>

    
  
  </div>

    <!-- SCRIPTS -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/stickyfill.min.js"></script>
    <script src="js/jquery.fancybox.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    
    <script src="js/jquery.waypoints.min.js"></script>
    <script src="js/jquery.animateNumber.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/quill.min.js"></script>
    
    
    <script src="js/bootstrap-select.min.js"></script>
    
    <script src="js/custom.js"></script>
    <script src = "js/global.js"></script>
    <script>


      selectedKeywords = new Set();
      selectedLocation = null;
      //   jobSearchResults = null;
      const form = document.getElementById("job-form")
      const jobTitle = document.getElementById("job-title");
      const companyName = document.getElementById("company-name");
      const locationPicker = document.getElementById("location-picker");
      const skillPicker = document.getElementById("skill-picker");
      const keywordBox = document.getElementById("keyword-box"); 
      const loader = document.getElementById("loader");
      const overlayer = document.getElementById("overlayer");
      const submitButton = document.getElementById("submit-button");
      const expiryTime = document.getElementById("expiry-time");
      initLocationPicker();
      initSkillPicker();
      form.addEventListener("submit", fromSubmitListener);
        function addKeyword() {
            if (selectedKeywords.size == 3) {
            alert("You can select maximum 3 keywords");
            return;
            }
            if (selectedKeywords.has(this.value)) {
            return;
            }
            selectedKeywords.add(this.value);
            var node = document.createElement("LI");
            var textnode = document.createTextNode(this.value); 
 
            node.appendChild(textnode);
            node.setAttribute("name", this.value);                              // Append the text to <li>
            keywordBox.appendChild(node);
            node.addEventListener("mouseover", showCross);
            node.addEventListener("mouseleave", showLabel); 
            node.addEventListener("click", removeKeyword);
        }
  
        function initLocationPicker() {
            for (const [key, value] of Object.entries(locations)) {
                var option = document.createElement("option");
                option.setAttribute("id", key);
                option.text = key;
                locationPicker.addEventListener('change', changeLocation);
                locationPicker.add(option);
            }
        }
  
        function initSkillPicker() {
            for (const [key, value] of Object.entries(skills)) {
                var option = document.createElement("option");
                option.setAttribute("id", key);
                option.text = key;
                skillPicker.addEventListener('change',addKeyword);
                skillPicker.add(option);
            }
        }
        function changeLocation() {
            selectedLocation = this.value;
        }
  
        function showCross(){
          this.innerText = "X"
        }
  
        function removeKeyword() {
          keywordBox.removeChild(this);
          selectedKeywords.delete(this.getAttribute("name"));
        }
        function showLabel() {
          this.innerText = this.getAttribute("name");
        }
        
        function fromSubmitListener(event) {
          console.log("submit");
          event.preventDefault();
          jobDetails.jobTitle = jobTitle.value;
          jobDetails.companyName = companyName.value;
          var jobDescription = document.getElementsByClassName("ql-editor")[0];
          jobDetails.description = jobDescription.innerText;
          jobDetails.creationDate = Date.now();
          jobDetails.expiry = expiryTime.value;
          var latLng = locations[locationPicker.value];
          jobDetails.location.latitude = latLng.latitude;
          jobDetails.location.longitude = latLng.longitude;
          jobDetails.location.name = locationPicker.value;
          var jobKeyWords = Array.from(selectedKeywords);
          jobDetails.skills = [];
          for (var i = 0;i < jobKeyWords.length;i++) {
            jobDetails.skills.push(skills[jobKeyWords[i]]); 
          }
          console.log(jobDetails);
          postJob(jobDetails);
        }

        function postJob(job) {
          
            var xhttp = new XMLHttpRequest();

            xhttp.onreadystatechange = function() {
              if (this.readyState == 1) {
                overlayer.style.display = "block";
                loader.style.display = "block";
              } 
              if (this.readyState == 4){
                overlayer.style.display = "none";
                loader.style.display = "none";
                if (this.status == 200) {
                  // delay(3000);
                    saveResult = JSON.parse(this.responseText);
                    var responseMessage = "Job Post Created With id = " + saveResult;
                    alert(responseMessage);
                }
              } 
            };
            var url = "/jobs/postJob";
            var body = JSON.stringify(job);
            console.log(body);
          xhttp.open("POST", url, true);
          xhttp.setRequestHeader("content-type", "application/json");
          xhttp.send(body);
        }

        
        var jobDetails = {
          jobTitle:null,
          companyName:null,
          description:null,
          creationDate:null,
          expiry:"60",
          skills:null,
          location:{
            latitude:null,
            longitude:null,
            name:null
          }
        }

     </script>
     
   
   
     
  </body>
</html>